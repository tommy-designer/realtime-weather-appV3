{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\\\u9673\\u5A01\\u8C6A\\\\realtime-weather-appV3\\\\realtime-weather-appV3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\\\u9673\\u5A01\\u8C6A\\\\realtime-weather-appV3\\\\realtime-weather-appV3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\\\u9673\\u5A01\\u8C6A\\\\realtime-weather-appV3\\\\realtime-weather-appV3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{useCallback,useEffect,useState}from\"react\";import Moment from\"moment\";var fetchWeatherSunset=function fetchWeatherSunset(cityName){return fetch(\"https://opendata.cwb.gov.tw/api/v1/rest/datastore/A-B0062-001?Authorization=CWB-7F486B33-2521-43D0-A5E1-4368F085EF09&locationName=\".concat(cityName,\"&dataTime=\").concat(Moment().format('YYYY-MM-DD'))).then(function(response){return response.json();}).then(function(data){var sunsetData=data.records.locations.location[0].time[0].parameter;var sunRising=sunsetData.find(function(item){return item.parameterName==='日出時刻';});var sunFalling=sunsetData.find(function(item){return item.parameterName==='日沒時刻';});return{rising:sunRising.parameterValue,falling:sunFalling.parameterValue};});};var useSunsetApi=function useSunsetApi(currentLocation){var locationName=currentLocation.locationName,cityName=currentLocation.cityName;var _useState=useState(),_useState2=_slicedToArray(_useState,2),sunset=_useState2[0],setSunset=_useState2[1];var fetchData=useCallback(function(){// console.log(num);\nvar fetchingData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,currentSunset;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([fetchWeatherSunset(cityName)]);case 2:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,1);currentSunset=_yield$Promise$all2[0];setSunset(currentSunset);case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchingData(){return _ref.apply(this,arguments);};}();fetchingData();},[locationName,cityName]);useEffect(function(){// console.log(\"--- effect ---\");\nfetchData();},[fetchData]);return sunset;};export default useSunsetApi;","map":{"version":3,"sources":["C:/Users/陳威豪/realtime-weather-appV3/realtime-weather-appV3/src/useSunsetApi.js"],"names":["useCallback","useEffect","useState","Moment","fetchWeatherSunset","cityName","fetch","format","then","response","json","data","sunsetData","records","locations","location","time","parameter","sunRising","find","item","parameterName","sunFalling","rising","parameterValue","falling","useSunsetApi","currentLocation","locationName","sunset","setSunset","fetchData","fetchingData","Promise","all","currentSunset"],"mappings":"wlBAAA,OAAQA,WAAR,CAAqBC,SAArB,CAAgCC,QAAhC,KAA+C,OAA/C,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CAEA,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAAAC,QAAQ,CAAI,CACnC,MAAOC,CAAAA,KAAK,6IAC6HD,QAD7H,sBACkJF,MAAM,GAAGI,MAAT,CAAgB,YAAhB,CADlJ,EAAL,CAGFC,IAHE,CAGG,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EAHX,EAIFF,IAJE,CAIG,SAAAG,IAAI,CAAI,CACV,GAAMC,CAAAA,UAAU,CAAGD,IAAI,CAACE,OAAL,CAAaC,SAAb,CAAuBC,QAAvB,CAAgC,CAAhC,EAAmCC,IAAnC,CAAwC,CAAxC,EAA2CC,SAA9D,CAEA,GAAMC,CAAAA,SAAS,CAAGN,UAAU,CAACO,IAAX,CAAgB,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACC,aAAL,GAAuB,MAA3B,EAApB,CAAlB,CACA,GAAMC,CAAAA,UAAU,CAAGV,UAAU,CAACO,IAAX,CAAgB,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACC,aAAL,GAAuB,MAA3B,EAApB,CAAnB,CACA,MAAO,CACHE,MAAM,CAAEL,SAAS,CAACM,cADf,CAEHC,OAAO,CAAEH,UAAU,CAACE,cAFjB,CAAP,CAIH,CAbE,CAAP,CAcH,CAfD,CAiBA,GAAME,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAAC,eAAe,CAAI,IAC7BC,CAAAA,YAD6B,CACHD,eADG,CAC7BC,YAD6B,CACfvB,QADe,CACHsB,eADG,CACftB,QADe,eAERH,QAAQ,EAFA,wCAE7B2B,MAF6B,eAErBC,SAFqB,eAGpC,GAAMC,CAAAA,SAAS,CAAG/B,WAAW,CAAC,UAAM,CAChC;AACA,GAAMgC,CAAAA,YAAY,0FAAG,kNACaC,CAAAA,OAAO,CAACC,GAAR,CAAY,CACtC9B,kBAAkB,CAACC,QAAD,CADoB,CAAZ,CADb,kGACV8B,aADU,wBAIjBL,SAAS,CAACK,aAAD,CAAT,CAJiB,sDAAH,kBAAZH,CAAAA,YAAY,0CAAlB,CAOAA,YAAY,GACf,CAV4B,CAU1B,CAACJ,YAAD,CAAevB,QAAf,CAV0B,CAA7B,CAYAJ,SAAS,CAAC,UAAM,CACZ;AAEA8B,SAAS,GACZ,CAJQ,CAIN,CAACA,SAAD,CAJM,CAAT,CAKA,MAAOF,CAAAA,MAAP,CACH,CArBD,CAuBA,cAAeH,CAAAA,YAAf","sourcesContent":["import {useCallback, useEffect, useState} from \"react\";\r\nimport Moment from \"moment\";\r\n\r\nconst fetchWeatherSunset = cityName => {\r\n    return fetch(\r\n        `https://opendata.cwb.gov.tw/api/v1/rest/datastore/A-B0062-001?Authorization=CWB-7F486B33-2521-43D0-A5E1-4368F085EF09&locationName=${cityName}&dataTime=${Moment().format('YYYY-MM-DD')}`\r\n    )\r\n        .then(response => response.json())\r\n        .then(data => {\r\n            const sunsetData = data.records.locations.location[0].time[0].parameter;\r\n\r\n            const sunRising = sunsetData.find(item => item.parameterName === '日出時刻')\r\n            const sunFalling = sunsetData.find(item => item.parameterName === '日沒時刻')\r\n            return {\r\n                rising: sunRising.parameterValue,\r\n                falling: sunFalling.parameterValue\r\n            }\r\n        })\r\n}\r\n\r\nconst useSunsetApi = currentLocation => {\r\n    const {locationName, cityName} = currentLocation;\r\n    const [sunset, setSunset] = useState();\r\n    const fetchData = useCallback(() => {\r\n        // console.log(num);\r\n        const fetchingData = async () => {\r\n            const [currentSunset] = await Promise.all([\r\n                fetchWeatherSunset(cityName)\r\n            ]);\r\n            setSunset(currentSunset)\r\n        };\r\n\r\n        fetchingData();\r\n    }, [locationName, cityName]);\r\n\r\n    useEffect(() => {\r\n        // console.log(\"--- effect ---\");\r\n\r\n        fetchData();\r\n    }, [fetchData]);\r\n    return sunset\r\n}\r\n\r\nexport default useSunsetApi;"]},"metadata":{},"sourceType":"module"}