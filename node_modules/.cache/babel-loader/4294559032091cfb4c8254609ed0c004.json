{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\\\u9673\\u5A01\\u8C6A\\\\realtime-weather-appV3\\\\realtime-weather-appV3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"C:\\\\Users\\\\\\u9673\\u5A01\\u8C6A\\\\realtime-weather-appV3\\\\realtime-weather-appV3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  background-color: \",\";\\n  height: 100%;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useEffect,useMemo}from\"react\";import styled from\"@emotion/styled\";import{ThemeProvider}from\"emotion-theming\";import WeatherCard from\"./weatherCard\";import useWeatherApi from\"./useWeatherApi\";import useSunsetApi from\"./useSunsetApi\";import WeatherSetting from\"./WeatherSetting\";import{findLocation}from\"./utils\";import Moment from\"moment\";var theme={light:{backgroundColor:\"#ededed\",foregroundColor:\"#f9f9f9\",boxShadow:\"0 1px 3px 0 #999\",titleColor:\"#212121\",temperaturColor:\"#757575\",textColor:\"#828282\"},dark:{backgroundColor:\"#1f2022\",foregroundColor:\"#121416\",boxShadow:\"0 1px 0 rgba(12, 12, 13, 0.2), 0 0 0 1px rgba(0, 0, 0, 0.15)\",titleColor:\"#f9f9fa\",temperatrureColor:\"#ddd\",textColor:\"#ccc\"}};var Container=styled.div(_templateObject(),function(_ref){var theme=_ref.theme;return theme.backgroundColor;});var getMoment=function getMoment(locationName,sunset){if(!sunset)return null;var now=new Date();var sunriseTimestamp=new Date(\"\".concat(Moment().format('YYYY-MM-DD'),\" \").concat(sunset.rising)).getTime();var sunsetTimestamp=new Date(\"\".concat(Moment().format('YYYY-MM-DD'),\" \").concat(sunset.falling)).getTime();var nowTimeStamp=now.getTime();return sunriseTimestamp<=nowTimeStamp&&nowTimeStamp<=sunsetTimestamp?\"day\":\"night\";};var WeatherApp=function WeatherApp(){var storageCity=localStorage.getItem(\"cityName\");var _useState=useState(storageCity||\"臺北市\"),_useState2=_slicedToArray(_useState,2),currentCity=_useState2[0],setCurrentCity=_useState2[1];var currentLocation=findLocation(currentCity)||{};var _useWeatherApi=useWeatherApi(currentLocation),_useWeatherApi2=_slicedToArray(_useWeatherApi,2),weatherElement=_useWeatherApi2[0],fetchData=_useWeatherApi2[1];var _useState3=useState(\"light\"),_useState4=_slicedToArray(_useState3,2),currentTheme=_useState4[0],setCurrentTheme=_useState4[1];var _useState5=useState(\"WeatherCard\"),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var sunset=useSunsetApi(currentLocation);var moment=useMemo(function(){return getMoment(currentLocation.sunriseCityName,sunset);},[currentLocation.sunriseCityName]);useEffect(function(){setCurrentTheme(moment===\"day\"?\"light\":\"dark\");},[moment]);useEffect(function(){localStorage.setItem(\"cityName\",currentCity);},[currentCity]);return/*#__PURE__*/React.createElement(ThemeProvider,{theme:theme[currentTheme]},/*#__PURE__*/React.createElement(Container,null,currentPage===\"WeatherCard\"&&/*#__PURE__*/React.createElement(WeatherCard,{cityName:currentLocation.cityName,weatherElement:weatherElement,moment:moment,fetchData:fetchData,setCurrentPage:setCurrentPage}),currentPage===\"WeatherSetting\"&&/*#__PURE__*/React.createElement(WeatherSetting,{cityName:currentLocation.cityName,setCurrentCity:setCurrentCity,setCurrentPage:setCurrentPage})));};export default WeatherApp;","map":{"version":3,"sources":["C:/Users/陳威豪/realtime-weather-appV3/realtime-weather-appV3/src/WeatherApp.js"],"names":["React","useState","useEffect","useMemo","styled","ThemeProvider","WeatherCard","useWeatherApi","useSunsetApi","WeatherSetting","findLocation","Moment","theme","light","backgroundColor","foregroundColor","boxShadow","titleColor","temperaturColor","textColor","dark","temperatrureColor","Container","div","getMoment","locationName","sunset","now","Date","sunriseTimestamp","format","rising","getTime","sunsetTimestamp","falling","nowTimeStamp","WeatherApp","storageCity","localStorage","getItem","currentCity","setCurrentCity","currentLocation","weatherElement","fetchData","currentTheme","setCurrentTheme","currentPage","setCurrentPage","moment","sunriseCityName","setItem","cityName"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo } from \"react\";\nimport styled from \"@emotion/styled\";\nimport { ThemeProvider } from \"emotion-theming\";\nimport WeatherCard from \"./weatherCard\";\nimport useWeatherApi from \"./useWeatherApi\";\nimport useSunsetApi from \"./useSunsetApi\";\nimport WeatherSetting from \"./WeatherSetting\";\nimport { findLocation } from \"./utils\";\nimport Moment from \"moment\";\n\nconst theme = {\n  light: {\n    backgroundColor: \"#ededed\",\n    foregroundColor: \"#f9f9f9\",\n    boxShadow: \"0 1px 3px 0 #999\",\n    titleColor: \"#212121\",\n    temperaturColor: \"#757575\",\n    textColor: \"#828282\"\n  },\n  dark: {\n    backgroundColor: \"#1f2022\",\n    foregroundColor: \"#121416\",\n    boxShadow: \"0 1px 0 rgba(12, 12, 13, 0.2), 0 0 0 1px rgba(0, 0, 0, 0.15)\",\n    titleColor: \"#f9f9fa\",\n    temperatrureColor: \"#ddd\",\n    textColor: \"#ccc\"\n  }\n};\n\nconst Container = styled.div`\n  background-color: ${({ theme }) => theme.backgroundColor};\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst getMoment =(locationName,sunset) =>{\n  if(!sunset)return null;\n\n  const now = new Date();\n  \n  const sunriseTimestamp = new Date(\n     `${Moment().format('YYYY-MM-DD')} ${sunset.rising}`\n  ).getTime();\n  const sunsetTimestamp = new Date(\n       `${Moment().format('YYYY-MM-DD')} ${sunset.falling}`\n  ).getTime();\n  const nowTimeStamp = now.getTime();\n\n  return sunriseTimestamp <= nowTimeStamp && nowTimeStamp <= sunsetTimestamp\n    ? \"day\"\n    : \"night\";\n};\n\nconst WeatherApp = () => {\n  const storageCity = localStorage.getItem(\"cityName\");\n  const [currentCity, setCurrentCity] = useState(storageCity || \"臺北市\");\n  const currentLocation = findLocation(currentCity) || {};\n  const [weatherElement, fetchData] = useWeatherApi(currentLocation);\n  const [currentTheme, setCurrentTheme] = useState(\"light\");\n  const [currentPage, setCurrentPage] = useState(\"WeatherCard\");\n\n  const sunset = useSunsetApi(currentLocation)\n    const moment = useMemo(() => getMoment(currentLocation.sunriseCityName,sunset), [\n    currentLocation.sunriseCityName\n  ]);\n\n  useEffect(() => {\n    setCurrentTheme(moment === \"day\" ? \"light\" : \"dark\");\n  }, [moment]);\n\n  useEffect(() => {\n    localStorage.setItem(\"cityName\", currentCity);\n  }, [currentCity]);\n\n  return (\n    <ThemeProvider theme={theme[currentTheme]}>\n      <Container>\n        {currentPage === \"WeatherCard\" && (\n          <WeatherCard\n            cityName={currentLocation.cityName}\n            weatherElement={weatherElement}\n            moment={moment}\n            fetchData={fetchData}\n            setCurrentPage={setCurrentPage}\n          />\n        )}\n        {currentPage === \"WeatherSetting\" && (\n          <WeatherSetting\n            cityName={currentLocation.cityName}\n            setCurrentCity={setCurrentCity}\n            setCurrentPage={setCurrentPage}\n          />\n        )}\n      </Container>\n    </ThemeProvider>\n  );\n};\n\nexport default WeatherApp;\n"]},"metadata":{},"sourceType":"module"}